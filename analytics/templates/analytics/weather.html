{% extends 'analytics/main.html' %}
{% load static %}

{% block main %}

<!-- Content Start -->
<div class="content">
    <!-- Navbar Start -->
    {% include 'analytics/nav.html' %}
    <!-- Navbar End -->

        
    <!-- Weather Metrics Start -->
    <div class="container-fluid pt-4 px-4">
        <div class="row g-4">
            <!-- Current Temperature -->
            <div class="col-sm-6 col-xl-3">
                <div class="bg-secondary rounded d-flex align-items-center justify-content-between p-4">
                    <i class="fas fa-thermometer-half fa-3x text-warning"></i>
                    <div class="ms-3">
                        <p class="mb-2">Current Temperature</p>
                        <h6 class="mb-0">{{ analysis.current_conditions.temperature.value }}°C</h6>
                        <small class="text-muted">Feels like {{ analysis.current_conditions.temperature.feels_like }}°C</small>
                    </div>
                </div>
            </div>
            
            <!-- Weather Condition -->
            <div class="col-sm-6 col-xl-3">
                <div class="bg-secondary rounded d-flex align-items-center justify-content-between p-4">
                    <i class="fas fa-cloud fa-3x text-info"></i>
                    <div class="ms-3">
                        <p class="mb-2">Weather Condition</p>
                        <h6 class="mb-0">{{ analysis.current_conditions.condition_code }}</h6>
                        <small class="text-muted">{{ analysis.current_conditions.cloud_cover.value }}% cloud cover</small>
                    </div>
                </div>
            </div>
            
            <!-- Wind Conditions -->
            <div class="col-sm-6 col-xl-3">
                <div class="bg-secondary rounded d-flex align-items-center justify-content-between p-4">
                    <i class="fas fa-wind fa-3x text-primary"></i>
                    <div class="ms-3">
                        <p class="mb-2">Wind Speed</p>
                        <h6 class="mb-0">{{ analysis.current_conditions.wind.speed }} {{ analysis.current_conditions.wind.unit }}</h6>
                        <small class="text-muted">From {{ analysis.current_conditions.wind.direction }}°</small>
                    </div>
                </div>
            </div>
            
            <!-- Humidity & Pressure -->
            <div class="col-sm-6 col-xl-3">
                <div class="bg-secondary rounded d-flex align-items-center justify-content-between p-4">
                    <i class="fas fa-tint fa-3x text-success"></i>
                    <div class="ms-3">
                        <p class="mb-2">Relative Humidity</p>
                        <h6 class="mb-0">{{ analysis.current_conditions.humidity.value }}%</h6>
                        <small class="text-muted">{{ analysis.current_conditions.precipitation.type|title }}</small>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Weather Metrics End -->

    <!-- Current Conditions Start -->
    <div class="container-fluid pt-4 px-4">
        <div class="row g-4">
            <!-- Current Weather Widget -->
            <div class="col-sm-12 col-md-6 col-xl-3">
                <div class="bg-secondary rounded p-4">
                    <h6 class="mb-3 text-info">Current Conditions</h6>
                    <div class="d-flex justify-content-between mb-2">
                        <span>Visibility</span>
                        <strong>{{ analysis.current_conditions.visibility.value }} {{ analysis.current_conditions.visibility.unit }}</strong>
                    </div>
                    <div class="d-flex justify-content-between mb-2">
                        <span>UV Index</span>
                        <strong>{{ analysis.daily_analysis.daily_breakdown.0.solar.uv_index_max }}</strong>
                    </div>
                    <div class="d-flex justify-content-between">
                        <span>Wind Gust</span>
                        <strong>{{ analysis.current_conditions.wind.gusts }} {{ analysis.current_conditions.wind.unit }}</strong>
                    </div>
                </div>
            </div>
            
            <!-- Sun & Moon Times -->
            <div class="col-sm-12 col-md-6 col-xl-3">
                <div class="bg-secondary rounded p-4">
                    <h6 class="mb-3 text-warning">Sun Events</h6>
                    <div class="d-flex justify-content-between mb-2">
                        <span>Sunrise</span>
                        <strong class="text-warning">{{ analysis.daily_analysis.daily_breakdown.0.sunrise }}</strong>
                    </div>
                    <div class="d-flex justify-content-between mb-2">
                        <span>Sunset</span>
                        <strong class="text-warning">{{ analysis.daily_analysis.daily_breakdown.0.sunset }}</strong>
                    </div>
                    <div class="d-flex justify-content-between">
                        <span>Daylight</span>
                        <strong class="text-warning">{{ analysis.daily_analysis.daily_breakdown.0.daylight_hours }}h</strong>
                    </div>
                </div>
            </div>
            
            <!-- Weather Alerts Status -->
            <div class="col-sm-12 col-md-6 col-xl-3">
                <div class="bg-secondary rounded p-4">
                    <h6 class="mb-3 text-danger">Weather Alerts</h6>
                    <div class="d-flex justify-content-between mb-2">
                        <span>Active Alerts</span>
                        <span class="badge bg-danger">{{ analysis.weather_alerts.total }} Active</span>
                    </div>
                    <div class="d-flex justify-content-between mb-2">
                        <span>Severity</span>
                        {% if analysis.weather_alerts %}
                        <span class="badge bg-warning">{{ analysis.weather_alerts.alerts.0.level }}</span>
                        {% else %}
                        <span class="badge bg-success">None</span>
                        {% endif %}
                    </div>
                    <div class="d-flex justify-content-between">
                        <span>Status</span>
                        <small>{% if analysis.weather_alerts %}Monitoring{% else %}Clear{% endif %}</small>
                    </div>
                </div>
            </div>
            
            <!-- Data Freshness -->
            <div class="col-sm-12 col-md-6 col-xl-3">
                <div class="bg-secondary rounded p-4">
                    <h6 class="mb-3 text-primary">Data Status</h6>
                    <div class="d-flex justify-content-between mb-2">
                        <span>Last Updated</span>
                        <small>{{ analysis.timestamps.analysis_time }}</small>
                    </div>
                    <div class="d-flex justify-content-between mb-2">
                        <span>Data Quality</span>
                        <span class="badge bg-success">High</span>
                    </div>
                    <div class="d-flex justify-content-between">
                        <span>Data Source</span>
                        <small>Openmeteo</small>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Current Conditions End -->

    <!-- Weather Charts Start -->
    <div class="container-fluid pt-4 px-4">
        <div class="row g-4">
            <!-- Hourly Forecast -->
            <div class="col-sm-12 col-xl-6">
                <div class="bg-secondary text-center rounded p-4">
                    <div class="d-flex align-items-center justify-content-between mb-4">
                        <h6 class="mb-0">analysis.hourly_analysis.time_period</h6>
                        <a href="hourly.html">View Details</a>
                        <div class="dropdown">
                            <a href="#" class="" type="button" id="hourlyOptions" data-bs-toggle="dropdown" aria-expanded="false">
                                Options
                            </a>
                            <div class="dropdown-menu dropdown-menu-end p-3 bg-secondary" style="min-width: 250px;">
                                <form id="hourlyForecastOptions">
                                    <div class="mb-3">
                                        <label for="parameterSelect" class="form-label small fw-bold text-muted">PARAMETER</label>
                                        <select class="form-select form-select-sm" id="parameterSelect">
                                            <option selected>Temperature</option>
                                            <option value="precipitation">Precipitation</option>
                                            <option value="humidity">Humidity</option>
                                            <option value="wind">Wind Speed</option>
                                            <option value="pressure">Pressure</option>
                                        </select>
                                    </div>
                                    <div class="mb-3">
                                        <label for="timeRange" class="form-label small fw-bold text-muted">TIME RANGE</label>
                                        <select class="form-select form-select-sm" id="timeRange">
                                            <option selected>24 hours</option>
                                            <option value="48">48 hours</option>
                                            <option value="72">72 hours</option>
                                        </select>
                                    </div>
                                    <button type="submit" class="btn btn-sm btn-primary w-100">Apply Filters</button>
                                </form>
                            </div>
                        </div>
                    </div>
                    <div id="hourly-chart">{{ hourly_chart|safe }}</div>
                </div>
            </div>
            
            <!-- Daily Forecast -->
            <div class="col-sm-12 col-xl-6">
                <div class="bg-secondary text-center rounded p-4">
                    <div class="d-flex align-items-center justify-content-between mb-4">
                        <h6 class="mb-0">{{ analysis.daily_analysis.time_period }}</h6>
                        <a href="daily.html">View Details</a>
                    </div>
                    <div id="daily-forecast-chart">{{ daily_chart|safe }}</div>
                </div>
            </div>
        </div>
    </div>
    <!-- Weather Charts End -->

    <!-- Weather Alerts Overview Start -->
    <div class="container-fluid pt-4 px-4">
        <div class="row g-4">
            <div class="col-sm-12 col-md-6 col-xl-8 bg-secondary text-center rounded p-4">
                <div class="d-flex align-items-center justify-content-between mb-4">
                    <h6 class="mb-0">Active Weather Alerts</h6>
                    <a href="">View All</a>
                </div>
                <div class="table-responsive">
                    <table class="table text-start align-middle table-bordered table-hover mb-0">
                        <thead>
                            <tr class="text-white">
                                <th scope="col">Alert Type</th>
                                <th scope="col">Level</th>
                                <th scope="col">Message</th>
                                <th scope="col">Details</th>
                                <th scope="col">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for alert in analysis.weather_alerts.alerts %}
                            <tr>
                                <td>{{ alert.type }}</td>
                                <td>
                                    {% if alert.level == 'SEVERE' %}
                                    <span class="badge bg-danger">{{ alert.level }}</span>
                                    {% elif alert.level == 'MODERATE' %}
                                    <span class="badge bg-warning">{{ alert.level }}</span>
                                    {% else %}
                                    <span class="badge bg-info">{{ alert.level }}</span>
                                    {% endif %}
                                </td>
                                <td>{{ alert.message }}</td>
                                <td>{{ alert.details }}</td>
                                <td>
                                    <a class="btn btn-sm btn-primary" href="">Map</a>
                                </td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="5" class="text-center text-muted">No active weather alerts</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            <!-- Weather Factors -->
            <div class="col-sm-12 col-md-6 col-xl-4">
                <div class="h-100 bg-secondary rounded p-4">
                    <div class="d-flex align-items-center justify-content-between mb-2">
                        <h6 class="mb-0">Weather Factors</h6>
                        <a href="details.html">View All</a>
                    </div>
                    <div class="d-flex align-items-center border-bottom py-3">
                        <div class="rounded-circle bg-warning d-flex align-items-center justify-content-center me-3" style="width: 40px; height: 40px;">
                            <i class="fas fa-cloud-rain text-dark"></i>
                        </div>
                        <div class="w-100 ms-3">
                            <div class="d-flex w-100 justify-content-between">
                                <h6 class="mb-0">Precipitation</h6>
                                <small>{{ analysis.hourly_analysis.precipitation_analysis.precipitation_probability_avg }}%</small>
                            </div>
                            <span>{{ analysis.current_conditions.precipitation.type|title }} conditions</span>
                        </div>
                    </div>
                    <div class="d-flex align-items-center border-bottom py-3">
                        <div class="rounded-circle bg-info d-flex align-items-center justify-content-center me-3" style="width: 40px; height: 40px;">
                            <i class="fas fa-temperature-low text-dark"></i>
                        </div>
                        <div class="w-100 ms-3">
                            <div class="d-flex w-100 justify-content-between">
                                <h6 class="mb-0">Temperature Range</h6>
                                <small>{{ analysis.hourly_analysis.temperature_analysis.min_temp }}° - {{ analysis.hourly_analysis.temperature_analysis.max_temp }}°</small>
                            </div>
                            <span>{{ analysis.hourly_analysis.temperature_analysis.trend|title }} trend</span>
                        </div>
                    </div>
                    <div class="d-flex align-items-center border-bottom py-3">
                        <div class="rounded-circle bg-success d-flex align-items-center justify-content-center me-3" style="width: 40px; height: 40px;">
                            <i class="fas fa-eye text-dark"></i>
                        </div>
                        <div class="w-100 ms-3">
                            <div class="d-flex w-100 justify-content-between">
                                <h6 class="mb-0">Visibility</h6>
                                <small>{{ analysis.current_conditions.visibility.value }} {{ analysis.current_conditions.visibility.unit }}</small>
                            </div>
                            <span>Clear visibility conditions</span>
                        </div>
                    </div>
                    <div class="d-flex align-items-center pt-3">
                        <div class="rounded-circle bg-primary d-flex align-items-center justify-content-center me-3" style="width: 40px; height: 40px;">
                            <i class="fas fa-compress-arrows-alt text-dark"></i>
                        </div>
                        <div class="w-100 ms-3">
                            <div class="d-flex w-100 justify-content-between">
                                <h6 class="mb-0">Solar Energy</h6>
                                <small>{{ analysis.hourly_analysis.solar_analysis.total_sunshine_hours }}h</small>
                            </div>
                            <span>Sunshine duration</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Weather Alerts Overview End -->

    <!-- Weather Widgets Start -->
    <div class="container-fluid pt-4 px-4">
        <div class="row g-4">            
           <!-- Weather Summary -->
            <div class="col-sm-12 col-md-6 col-xl-4">
                <div class="h-100 bg-secondary rounded p-4">
                    <!-- Header -->
                    <div class="d-flex align-items-center justify-content-between mb-3">
                        <h6 class="mb-0 text-warning">Weather Summary</h6>
                    </div>

                    <!-- Key Statistics -->
                    <div class="mb-4">
                        <h6 class="mb-3 text-light">Statistics</h6>

                        <!-- Average Temperature -->
                        <div class="mb-3">
                            <small>Avg Temperature: 
                                <span class="text-success fw-bold">
                                    {{ analysis.hourly_analysis.temperature_analysis.avg_temp }}°C
                                </span>
                            </small>
                            <div class="progress" style="height: 6px;">
                                <div class="progress-bar bg-success" role="progressbar"
                                     style="width: {{ analysis.hourly_analysis.temperature_analysis.avg_temp }}%;">
                                </div>
                            </div>
                        </div>

                        <!-- Precipitation -->
                        <div class="mb-3">
                            <small>Precipitation: 
                                <span class="text-primary fw-bold">
                                    {{ analysis.hourly_analysis.precipitation_analysis.total_precipitation }}mm
                                </span>
                            </small>
                            <div class="progress" style="height: 6px;">
                                <div class="progress-bar bg-primary" role="progressbar"
                                     style="width: {{ analysis.hourly_analysis.precipitation_analysis.total_precipitation }}%;">
                                </div>
                            </div>
                        </div>

                        <!-- Sunshine -->
                        <div class="mb-3">
                            <small>Sunshine: 
                                <span class="text-warning fw-bold">
                                    {{ analysis.hourly_analysis.solar_analysis.total_sunshine_hours }}h
                                </span>
                            </small>
                            <div class="progress" style="height: 6px;">
                                <div class="progress-bar bg-warning" role="progressbar"
                                     style="width: {{ analysis.hourly_analysis.solar_analysis.total_sunshine_hours }}%;">
                                </div>
                            </div>
                        </div>

                    </div>

                    <!-- Summary Section -->
                    <div class="border-top border-light pt-3">
                        <div class="d-flex justify-content-between mb-2">
                            <span>Overall Condition:</span>
                            <span class="text-warning fw-bold">{{ analysis.summary.overall_condition }}</span>
                        </div>
                        <div class="d-flex justify-content-between mb-2">
                            <span>Comfort Hours:</span>
                            <span class="text-success fw-bold">{{ analysis.hourly_analysis.temperature_analysis.comfort_hours }}h</span>
                        </div>
                        <div class="d-flex justify-content-between mb-2">
                            <span>Rain Hours:</span>
                            <span class="text-primary fw-bold">{{ analysis.hourly_analysis.precipitation_analysis.precipitation_hours }}h</span>
                        </div>
                        <div class="d-flex justify-content-between mb-3">
                            <span>Heavy Precipitation:</span>
                            <span class="text-info fw-bold">{{ analysis.hourly_analysis.precipitation_analysis.heavy_precipitation_hours }}h</span>
                        </div>
                    </div>

                </div>
            </div>


            <!-- Location & API Info -->
            <div class="col-sm-12 col-md-6 col-xl-4">
                <div class="bg-secondary rounded p-4 h-100">
                    <!-- Section Header -->
                    <h6 class="mb-4 text-warning border-bottom border-light pb-2">Location & API Information</h6>

                    <!-- Table -->
                    <div class="table-responsive mb-4">
                        <table class="table table-sm table-borderless align-middle">
                            <tbody>
                                <tr>
                                    <td class="fw-bold text-light">Location</td>
                                    <td class="text-light">{{ analysis.location_info.location_name }}</td>
                                    <td class="text-muted small">Monitoring location</td>
                                </tr>
                                <tr>
                                    <td class="fw-bold text-light">Latitude</td>
                                    <td class="text-light">{{ analysis.location_info.latitude }}</td>
                                    <td class="text-muted small">Location latitude</td>
                                </tr>
                                <tr>
                                    <td class="fw-bold text-light">Longitude</td>
                                    <td class="text-light">{{ analysis.location_info.longitude }}</td>
                                    <td class="text-muted small">Location longitude</td>
                                </tr>
                                <tr>
                                    <td class="fw-bold text-light">Elevation</td>
                                    <td class="text-light">{{ analysis.location_info.elevation }} m</td>
                                    <td class="text-muted small">Location elevation</td>
                                </tr>
                                <tr>
                                    <td class="fw-bold text-light">Timezone</td>
                                    <td class="text-light">{{ analysis.location_info.timezone }}</td>
                                    <td class="text-muted small">Location timezone</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Recommendations -->
                    <div class="border-top border-light pt-3">
                        <h6 class="mb-3 text-warning">Recommendations</h6>
                        {% for recommendation in analysis.summary.recommendations %}
                        <div class="d-flex align-items-start mb-2">
                            <i class="fas fa-check-circle text-success me-2 mt-1"></i>
                            <small class="text-light">{{ recommendation }}</small>
                        </div>
                        {% empty %}
                        <small class="text-muted">No specific recommendations</small>
                        {% endfor %}
                    </div>
                </div>
            </div>


            <!-- Location Parameters -->
            <div class="col-sm-12 col-md-6 col-xl-4">
                <div class="card shadow-sm h-100 bg-secondary p-3">
                    <div class="">
                        <h6 class="mb-0 text-warning px-3"></i> Select Location</h6>
                    </div>

                    <div class="card-body">
                        <div class="row g-2">
                            <div class="col-6">
                                <label class="form-label small">Latitude</label>
                                <input type="number" class="form-control form-control-sm" name="lat" value="-1.286389" step="any">
                            </div>
                            <div class="col-6">
                                <label class="form-label small">Longitude</label>
                                <input type="number" class="form-control form-control-sm" name="lon" value="36.817223" step="any">
                            </div>
                            <div class="col-12">
                                <label class="form-label small">Location Name</label>
                                <input type="text" class="form-control form-control-sm" name="name" value="Nairobi">
                            </div>
                            <div class="col-12">
                                <label class="form-label small">Timezone</label>
                                <select class="form-select form-select-sm" name="tz">
                                    <option selected value="Africa/Nairobi">Africa/Nairobi</option>
                                    <option>UTC</option>
                                </select>
                            </div>
                            <div class="col-12">
                                <div class="d-flex justify-content-end mt-4">
                                    <button type="submit" class="btn btn-warning btn-sm">
                                        <i class="fas fa-bolt me-1"></i> Fetch Weather Data
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Weather Widgets End -->

    <!-- Detailed Forecast Start -->
    <div class="container-fluid pt-4 px-4">
        <div class="row g-4">
            <!-- Hourly Breakdown -->
            <div class="col-sm-12 col-xl-6">
                <div class="bg-secondary rounded p-4">
                    <h6 class="mb-4 text-warning">Next 24 Hours - Hour by Hour</h6>
                    <div class="table-responsive" style="max-height: 22rem; overflow-y: auto;">
                        <table class="table table-hover align-middle">
                            <thead class="table-dark sticky-top text-light">
                                <tr>
                                    <th>Time</th>
                                    <th>Temp</th>
                                    <th>Weather</th>
                                    <th>Precip</th>
                                    <th>Precip Amnt</th>
                                    <th>Radiation</th>
                                    <th>Sunshine</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for hour in analysis.hourly_analysis.hourly_breakdown|slice:"-18:" %}
                                <tr>
                                    <td>{{ hour.time }}</td>
                                    <td>{{ hour.temperature }}°C</td>
                                    <td>
                                        {% if hour.condition == 'SUNNY' %}
                                        <i class="fas fa-sun text-warning"></i>
                                        {% elif hour.condition == 'PARTLY_CLOUDY' %}
                                        <i class="fas fa-cloud-sun text-info"></i>
                                        {% elif hour.condition == 'CLOUDY' %}
                                        <i class="fas fa-cloud text-secondary"></i>
                                        {% elif hour.condition == 'RAINY' %}
                                        <i class="fas fa-cloud-rain text-primary"></i>
                                        {% else %}
                                        <i class="fas fa-cloud text-info"></i>
                                        {% endif %}
                                    </td>
                                    <td>{{ hour.precipitation.probability }}%</td>
                                    <td>{{ hour.precipitation.amount }}mm</td>
                                    <td>{{ hour.solar.radiation }}W/m</td>
                                    <td>{{ hour.solar.sunshine }}W/m</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Daily Forecast Details -->
            <div class="col-sm-12 col-xl-6">
                <div class="bg-secondary rounded p-4">
                    <h6 class="mb-4 text-warning">7-Day Forecast Details</h6>
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead class="table-dark text-light">
                                <tr>
                                    <th>Day</th>
                                    <th>High/Low</th>
                                    <th>Weather</th>
                                    <th>Precip</th>
                                    <th>Sun</th>
                                    <th>UV</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for day in analysis.daily_analysis.daily_breakdown %}
                                <tr>
                                    <td>{{ day.date }}</td>
                                    <td>{{ day.max_temperature }}° / {{ day.min_temperature }}°</td>
                                    <td>
                                        {% if day.weather_condition == 'SUNNY' %}
                                        <i class="fas fa-sun text-warning"></i>
                                        {% elif day.weather_condition == 'PARTLY_CLOUDY' %}
                                        <i class="fas fa-cloud-sun text-info"></i>
                                        {% elif day.weather_condition == 'CLOUDY' %}
                                        <i class="fas fa-cloud text-secondary"></i>
                                        {% elif day.weather_condition == 'RAINY' %}
                                        <i class="fas fa-cloud-rain text-primary"></i>
                                        {% elif day.weather_condition == 'OCCASIONAL_RAIN' %}
                                        <i class="fas fa-cloud-drizzle text-info"></i>
                                        {% else %}
                                        <i class="fas fa-cloud text-info"></i>
                                        {% endif %}
                                    </td>
                                    <td>{{ day.precipitation.probability }}%</td>
                                    <td>{{ day.solar.sunshine_hours }}h</td>
                                    <td>{{ day.solar.uv_index_max }}</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Detailed Forecast End -->





















    <!-- Data Sources & Methodology Documentation -->
    <div class="container-fluid pt-4 px-4">
        <div class="row g-4">
            <div class="col-12">
                <div class="bg-secondary rounded p-4">
                    <div class="d-flex align-items-center justify-content-between mb-4">
                        <h5 class="mb-0">Weather Data Sources & Methodology</h5>
                        <button type="button" class="btn btn-sm btn-outline-light" data-bs-toggle="collapse" data-bs-target="#dataSourcesCollapse">
                            <i class="fas fa-database me-1"></i>Toggle Data Documentation
                        </button>
                    </div>
                    
                    <div class="collapse show" id="dataSourcesCollapse">
                        <div class="accordion" id="dataSourcesAccordion">
                            
                            <!-- API Providers Section -->
                            <div class="accordion-item bg-dark border-dark">
                                <h2 class="accordion-header">
                                    <button class="accordion-button bg-dark text-light" type="button" data-bs-toggle="collapse" data-bs-target="#apiProviders">
                                        <i class="fas fa-cloud me-2"></i>Weather Data Providers
                                    </button>
                                </h2>
                                <div id="apiProviders" class="accordion-collapse collapse show" data-bs-parent="#dataSourcesAccordion">
                                    <div class="accordion-body">
                                        <div class="row g-4">
                                            <div class="col-md-4 text-center">
                                                <div class="border rounded p-3 bg-dark">
                                                    <i class="fas fa-cloud-sun fa-2x text-warning mb-3"></i>
                                                    <h6 class="text-warning">OpenWeather API</h6>
                                                    <p class="text-light small mb-2">Current & Forecast Data</p>
                                                    <span class="badge bg-success">Primary Data Source</span>
                                                    <p class="text-light small mt-2">Provides real-time weather data and forecasts</p>
                                                </div>
                                            </div>
                                            <div class="col-md-4 text-center">
                                                <div class="border rounded p-3 bg-dark">
                                                    <i class="fas fa-satellite fa-2x text-info mb-3"></i>
                                                    <h6 class="text-info">NOAA/NWS</h6>
                                                    <p class="text-light small mb-2">National Weather Service</p>
                                                    <span class="badge bg-info">Official Alerts</span>
                                                    <p class="text-light small mt-2">Severe weather alerts and warnings</p>
                                                </div>
                                            </div>
                                            <div class="col-md-4 text-center">
                                                <div class="border rounded p-3 bg-dark">
                                                    <i class="fas fa-globe-americas fa-2x text-primary mb-3"></i>
                                                    <h6 class="text-primary">Location Services</h6>
                                                    <p class="text-light small mb-2">Geocoding & Timezone</p>
                                                    <span class="badge bg-primary">Geographic Data</span>
                                                    <p class="text-light small mt-2">Location-based weather services</p>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="alert alert-info mt-3">
                                            <small>
                                                <i class="fas fa-sync-alt me-2"></i>
                                                <strong>Data Integration:</strong> We combine real-time weather observations with forecast models and official alerts to provide comprehensive weather information.
                                            </small>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Data Structure -->
                            <div class="accordion-item bg-dark border-dark">
                                <h2 class="accordion-header">
                                    <button class="accordion-button bg-dark text-light collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#dataStructure">
                                        <i class="fas fa-code me-2"></i>Weather Data Structure
                                    </button>
                                </h2>
                                <div id="dataStructure" class="accordion-collapse collapse" data-bs-parent="#dataSourcesAccordion">
                                    <div class="accordion-body">
                                        <h6 class="text-warning mb-3">API Response Structure</h6>
                                        <div class="row g-3 mb-4">
                                            <div class="col-md-6">
                                                <h6 class="text-info">Current Weather Data</h6>
                                                <ul class="text-light small">
                                                    <li><strong>Temperature:</strong> Current, feels like, min, max</li>
                                                    <li><strong>Atmospheric:</strong> Pressure, humidity, visibility</li>
                                                    <li><strong>Wind:</strong> Speed, direction, gust</li>
                                                    <li><strong>Weather:</strong> Conditions, description, icon</li>
                                                    <li><strong>Astronomical:</strong> Sunrise, sunset times</li>
                                                </ul>
                                            </div>
                                            <div class="col-md-6">
                                                <h6 class="text-info">Forecast Data</h6>
                                                <ul class="text-light small">
                                                    <li><strong>Minutely:</strong> Precipitation for next hour</li>
                                                    <li><strong>Hourly:</strong> 48-hour forecast with intervals</li>
                                                    <li><strong>Daily:</strong> 7-day forecast with details</li>
                                                    <li><strong>Alerts:</strong> Severe weather notifications</li>
                                                </ul>
                                            </div>
                                        </div>

                                        <h6 class="text-warning mb-3">Data Processing Pipeline</h6>
                                        <div class="row text-center mb-4">
                                            <div class="col-md-3">
                                                <div class="border rounded p-2 bg-success">
                                                    <small class="fw-bold">Step 1</small>
                                                    <div class="text-light">API Request</div>
                                                    <i class="fas fa-paper-plane mt-1"></i>
                                                </div>
                                                <small class="text-light">Send location coordinates</small>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="border rounded p-2 bg-info">
                                                    <small class="fw-bold">Step 2</small>
                                                    <div class="text-light">Data Retrieval</div>
                                                    <i class="fas fa-download mt-1"></i>
                                                </div>
                                                <small class="text-light">Fetch weather data</small>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="border rounded p-2 bg-warning">
                                                    <small class="fw-bold">Step 3</small>
                                                    <div class="text-light">Processing</div>
                                                    <i class="fas fa-cogs mt-1"></i>
                                                </div>
                                                <small class="text-light">Format and analyze data</small>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="border rounded p-2 bg-primary">
                                                    <small class="fw-bold">Step 4</small>
                                                    <div class="text-light">Presentation</div>
                                                    <i class="fas fa-chart-line mt-1"></i>
                                                </div>
                                                <small class="text-light">Display to users</small>
                                            </div>
                                        </div>

                                        <div class="row g-3">
                                            <div class="col-md-6">
                                                <h6 class="text-success">Sample Data Structure</h6>
                                                <div class="bg-dark p-3 rounded">
                                                    <code class="text-light small">
    {<br>
    &nbsp;&nbsp;"lat": 33.44,<br>
    &nbsp;&nbsp;"lon": -94.04,<br>
    &nbsp;&nbsp;"timezone": "America/Chicago",<br>
    &nbsp;&nbsp;"current": {<br>
    &nbsp;&nbsp;&nbsp;&nbsp;"dt": 1684929490,<br>
    &nbsp;&nbsp;&nbsp;&nbsp;"temp": 292.55,<br>
    &nbsp;&nbsp;&nbsp;&nbsp;"weather": [{...}]<br>
    &nbsp;&nbsp;},<br>
    &nbsp;&nbsp;"hourly": [...],<br>
    &nbsp;&nbsp;"daily": [...],<br>
    &nbsp;&nbsp;"alerts": [...]<br>
    }
                                                    </code>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <h6 class="text-success">Key Data Fields</h6>
                                                <ul class="text-light small">
                                                    <li><strong>dt:</strong> Unix timestamp of data point</li>
                                                    <li><strong>temp:</strong> Temperature in Kelvin</li>
                                                    <li><strong>feels_like:</strong> Human perception of temperature</li>
                                                    <li><strong>pressure:</strong> Atmospheric pressure (hPa)</li>
                                                    <li><strong>humidity:</strong> Relative humidity (%)</li>
                                                    <li><strong>weather:</strong> Array of weather conditions</li>
                                                    <li><strong>wind_speed:</strong> Wind speed (m/s)</li>
                                                    <li><strong>pop:</strong> Probability of precipitation</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Data Quality & Accuracy -->
                            <div class="accordion-item bg-dark border-dark">
                                <h2 class="accordion-header">
                                    <button class="accordion-button bg-dark text-light collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#dataQuality">
                                        <i class="fas fa-check-circle me-2"></i>Data Quality & Accuracy
                                    </button>
                                </h2>
                                <div id="dataQuality" class="accordion-collapse collapse" data-bs-parent="#dataSourcesAccordion">
                                    <div class="accordion-body">
                                        <div class="row g-3">
                                            <div class="col-md-6">
                                                <h6 class="text-warning">Accuracy Estimates</h6>
                                                <div class="table-responsive">
                                                    <table class="table table-sm table-dark">
                                                        <thead>
                                                            <tr>
                                                                <th>Data Type</th>
                                                                <th>Accuracy</th>
                                                                <th>Update Frequency</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr>
                                                                <td>Current Conditions</td>
                                                                <td><span class="badge bg-success">±0.5°C</span></td>
                                                                <td>10 minutes</td>
                                                            </tr>
                                                            <tr>
                                                                <td>24-hour Forecast</td>
                                                                <td><span class="badge bg-warning">±1.5°C</span></td>
                                                                <td>Hourly</td>
                                                            </tr>
                                                            <tr>
                                                                <td>7-day Forecast</td>
                                                                <td><span class="badge bg-info">±3.0°C</span></td>
                                                                <td>Daily</td>
                                                            </tr>
                                                            <tr>
                                                                <td>Precipitation</td>
                                                                <td><span class="badge bg-success">±10%</span></td>
                                                                <td>15 minutes</td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <h6 class="text-warning">Limitations & Considerations</h6>
                                                <div class="text-light small">
                                                    <div class="mb-2">
                                                        <i class="fas fa-exclamation-triangle text-warning me-2"></i>
                                                        <strong>Local Variations:</strong> Microclimates and hyper-local conditions not fully captured
                                                    </div>
                                                    <div class="mb-2">
                                                        <i class="fas fa-exclamation-triangle text-warning me-2"></i>
                                                        <strong>Rapid Changes:</strong> Severe weather can develop faster than model updates
                                                    </div>
                                                    <div class="mb-2">
                                                        <i class="fas fa-exclamation-triangle text-warning me-2"></i>
                                                        <strong>Data Latency:</strong> Some data points may have 10-15 minute delay
                                                    </div>
                                                    <div class="mb-2">
                                                        <i class="fas fa-exclamation-triangle text-warning me-2"></i>
                                                        <strong>Model Uncertainty:</strong> Forecast accuracy decreases with time
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="alert alert-warning mt-3">
                                            <small>
                                                <i class="fas fa-info-circle me-2"></i>
                                                <strong>Note:</strong> Weather forecasts are estimates based on mathematical models. Always check official sources during severe weather events.
                                            </small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer Start -->
    <div class="container-fluid pt-4 px-4">
        <div class="bg-secondary rounded-top p-4">
            <div class="row">
                <div class="col-12 col-sm-6 text-center text-sm-start">
                    &copy; <a href="#">Weather Analytics Dashboard</a>, All Rights Reserved. 
                </div>
                <div class="col-12 col-sm-6 text-center text-sm-end">
                    Real-time Weather Data & Forecasts
                </div>
            </div>
        </div>
    </div>
    <!-- Footer End -->
</div>
<!-- Content End -->

{% endblock %}